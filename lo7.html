<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>لوحة تحكم السوبر ماركت</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, sans-serif;
      background: #0b1c2c;
      color: #fff;
      margin: 0;
      padding: 20px;
      text-align: center;
    }
    h1 {
      margin-bottom: 20px;
      color: #4db8ff;
    }
    .input-group {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
      margin-bottom: 15px;
    }
    input, button {
      padding: 10px;
      font-size: 16px;
      border-radius: 6px;
      border: none;
    }
    input {
      width: 180px;
    }
    button {
      background: #4db8ff;
      color: white;
      cursor: pointer;
      transition: background 0.3s;
    }
    button:hover {
      background: #3399cc;
    }
    table {
      width: 100%;
      max-width: 800px;
      margin: auto;
      border-collapse: collapse;
      background: #132f4c;
      border-radius: 8px;
      overflow: hidden;
    }
    th, td {
      padding: 12px;
      border-bottom: 1px solid #1e446b;
    }
    th {
      background: #1e446b;
      cursor: pointer;
    }
    tr:hover {
      background: #1a3758;
    }
    .actions button {
      margin: 0 3px;
      font-size: 14px;
      padding: 6px 10px;
    }
    .delete {
      background: #e74c3c;
    }
    .delete:hover {
      background: #c0392b;
    }
    .edit {
      background: #27ae60;
    }
    .edit:hover {
      background: #1e8449;
    }
  </style>
</head>
<body>

<h1>🛒 لوحة تحكم السوبر ماركت</h1>

<div class="input-group">
  <input type="text" id="name" placeholder="اسم المنتج">
  <input type="number" id="price" placeholder="السعر" min="0" step="0.01">
  <input type="number" id="quantity" placeholder="الكمية" min="0">
  <button onclick="addProduct()">➕ إضافة</button>
</div>

<table>
  <thead>
    <tr>
      <th>اسم المنتج</th>
      <th>السعر</th>
      <th>الكمية</th>
      <th>الخيارات</th>
    </tr>
  </thead>
  <tbody id="productTable"></tbody>
</table>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
<script>
  const firebaseConfig = {
    apiKey: "AIzaSyDm2WxkPe15845RS5RnTNZnRnlm1SMbSAM",
    authDomain: "appjx-d8c22.firebaseapp.com",
    databaseURL: "https://appjx-d8c22-default-rtdb.firebaseio.com",
    projectId: "appjx-d8c22",
    storageBucket: "appjx-d8c22.firebasestorage.app",
    messagingSenderId: "182238643819",
    appId: "1:182238643819:web:da345308cde59a9b8ed32e",
    measurementId: "G-MMZZ5Y7JK2"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  function addProduct() {
    let name = document.getElementById('name').value.trim();
    let price = parseFloat(document.getElementById('price').value);
    let quantity = parseInt(document.getElementById('quantity').value);

    if (!name || isNaN(price) || isNaN(quantity)) {
      alert("يرجى إدخال جميع البيانات بشكل صحيح");
      return;
    }

    let newProductRef = db.ref("products").push();
    newProductRef.set({
      name: name,
      price: price,
      quantity: quantity
    });

    document.getElementById('name').value = "";
    document.getElementById('price').value = "";
    document.getElementById('quantity').value = "";
  }

  function renderProducts() {
    db.ref("products").on("value", snapshot => {
      const table = document.getElementById("productTable");
      table.innerHTML = "";
      snapshot.forEach(child => {
        const product = child.val();
        const key = child.key;
        let row = document.createElement("tr");
        row.innerHTML = `
          <td>${product.name}</td>
          <td>${product.price.toFixed(2)}</td>
          <td>${product.quantity}</td>
          <td class="actions">
            <button class="edit" onclick="editProduct('${key}', '${product.name}', ${product.price}, ${product.quantity})">تعديل</button>
            <button class="delete" onclick="deleteProduct('${key}')">حذف</button>
          </td>
        `;
        table.appendChild(row);
      });
    });
  }

  function deleteProduct(key) {
    if (confirm("هل أنت متأكد من حذف هذا المنتج؟")) {
      db.ref("products/" + key).remove();
    }
  }

  function editProduct(key, name, price, quantity) {
    let newName = prompt("اسم المنتج:", name);
    let newPrice = parseFloat(prompt("السعر:", price));
    let newQuantity = parseInt(prompt("الكمية:", quantity));

    if (!newName || isNaN(newPrice) || isNaN(newQuantity)) {
      alert("تم إلغاء التعديل");
      return;
    }

    db.ref("products/" + key).update({
      name: newName,
      price: newPrice,
      quantity: newQuantity
    });
  }

  renderProducts();
</script>

</body>
</html>
